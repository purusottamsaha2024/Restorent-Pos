{% extends "base.html" %}

{% block title %}Petote POS{% endblock %}

{% block content %}
<div class="pos-container">
    <!-- Main Grid -->
    <div class="menu-grid">
        <!-- COMBO 1 -->
        <div class="menu-item main-item" data-name="Combo 1 (4 Pc)" data-price="3300" data-img="combo_1.png">
            <div class="item-number">1</div>
            <div class="item-image-container">
                <img src="/static/images/combo_4.png" alt="Combo 1">
            </div>
            <div class="qty-badge hidden" id="qty-Combo 1 (4 Pc)">0</div>
            <div class="item-info">
                <div class="item-name">Combo 1 (4 Pcs)</div>
                <div class="price-tag">‚Ç°3,300</div>
            </div>
        </div>

        <!-- COMBO 2 -->
        <div class="menu-item main-item" data-name="Combo 2 (8 Pc)" data-price="6500" data-img="combo_8.png">
            <div class="item-number">2</div>
            <div class="item-image-container">
                <img src="/static/images/combo_8.png" alt="Combo 2">
            </div>
            <div class="qty-badge hidden" id="qty-Combo 2 (8 Pc)">0</div>
            <div class="item-info">
                <div class="item-name">Combo 2 (8 Pcs)</div>
                <div class="price-tag">‚Ç°6,500</div>
            </div>
        </div>

        <!-- COMBO 3 -->
        <div class="menu-item main-item" data-name="Combo 3 (12 Pc)" data-price="9700" data-img="combo_12.png">
            <div class="item-number">3</div>
            <div class="item-image-container">
                <img src="/static/images/combo_12.png" alt="Combo 3">
            </div>
            <div class="qty-badge hidden" id="qty-Combo 3 (12 Pc)">0</div>
            <div class="item-info">
                <div class="item-name">Combo 3 (12 Pcs)</div>
                <div class="price-tag">‚Ç°9,700</div>
            </div>
        </div>

        <!-- COMBO 4 -->
        <div class="menu-item main-item" data-name="Combo 4 (16 Pc)" data-price="12800" data-img="combo_16.png">
            <div class="item-number">4</div>
            <div class="item-image-container">
                <img src="/static/images/combo_16.png" alt="Combo 4">
            </div>
            <div class="qty-badge hidden" id="qty-Combo 4 (16 Pc)">0</div>
            <div class="item-info">
                <div class="item-name">Combo 4 (16 Pcs)</div>
                <div class="price-tag">‚Ç°12,800</div>
            </div>
        </div>

        <!-- COMBO 5 -->
        <div class="menu-item main-item" data-name="Combo 5 (Fam 8)" data-price="10400" data-img="familiar.png">
            <div class="item-number">5</div>
            <div class="item-image-container">
                <img src="/static/images/familiar.png" alt="Combo 5">
            </div>
            <div class="qty-badge hidden" id="qty-Combo 5 (Fam 8)">0</div>
            <div class="item-info">
                <div class="item-name">Combo 5 (Fam 8)</div>
                <div class="price-tag">‚Ç°10,400</div>
            </div>
        </div>

        <!-- COMBO 6 -->
        <div class="menu-item main-item" data-name="Combo 6 (Fam 16)" data-price="16800" data-img="familiar.png">
            <div class="item-number">6</div>
            <div class="item-image-container">
                <img src="/static/images/familiar.png" alt="Combo 6">
            </div>
            <div class="qty-badge hidden" id="qty-Combo 6 (Fam 16)">0</div>
            <div class="item-info">
                <div class="item-name">Combo 6 (Fam 16)</div>
                <div class="price-tag">‚Ç°16,800</div>
            </div>
        </div>

        <!-- PERSONAL & PORTIONS -->
        <div class="menu-item main-item" data-name="Personal (2 Pc)" data-price="2000" data-img="personal.png">
            <div class="item-number">7</div>
            <div class="item-image-container">
                <img src="/static/images/personal.png" alt="Personal">
            </div>
            <div class="qty-badge hidden" id="qty-Personal (2 Pc)">0</div>
            <div class="item-info">
                <div class="item-name">Personal (2 Pc)</div>
                <div class="price-tag">‚Ç°2,000</div>
            </div>
        </div>

        <div class="menu-item main-item" data-name="Portion Breast+Wing" data-price="1800" data-img="personal.png">
            <div class="item-number">8</div>
            <div class="item-image-container">
                <img src="/static/images/personal.png" alt="Breast+Wing">
            </div>
            <div class="qty-badge hidden" id="qty-Portion Breast+Wing">0</div>
            <div class="item-info">
                <div class="item-name">Pechuga + Ala</div>
                <div class="price-tag">‚Ç°1,800</div>
            </div>
        </div>

        <div class="menu-item main-item" data-name="Portion Thigh+Leg" data-price="1500" data-img="personal.png">
            <div class="item-number">9</div>
            <div class="item-image-container">
                <img src="/static/images/personal.png" alt="Thigh+Leg">
            </div>
            <div class="qty-badge hidden" id="qty-Portion Thigh+Leg">0</div>
            <div class="item-info">
                <div class="item-name">Muslo + Cadera</div>
                <div class="price-tag">‚Ç°1,500</div>
            </div>
        </div>

        <!-- EXTRAS ROW -->
        <h2 style="grid-column: 1/-1; margin-top: 16px; margin-bottom: 8px; padding: 12px 0; border-bottom: 2px solid rgba(255, 215, 0, 0.3); color: var(--primary); font-size: 1.3rem; font-weight: 800; letter-spacing: 2px; text-align: center; text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);">EXTRAS</h2>

        <div class="menu-item extra-item" data-name="Fries" data-price="1000" data-img="fries_placeholder">
            <div class="item-number">10</div>
            <div class="item-image-container">
                <div class="placeholder-img" style="background: #e6b800;">üçü</div>
            </div>
            <div class="qty-badge hidden" id="qty-Fries">0</div>
            <div class="item-info">
                <div class="item-name">Fries</div>
                <div class="price-tag small">‚Ç°1,000</div>
            </div>
        </div>

        <div class="menu-item extra-item" data-name="Soda" data-price="800" data-img="soda_placeholder">
            <div class="item-number">11</div>
            <div class="item-image-container">
                <div class="placeholder-img" style="background: #cc0000;">ü•§</div>
            </div>
            <div class="qty-badge hidden" id="qty-Soda">0</div>
            <div class="item-info">
                <div class="item-name">Soda</div>
                <div class="price-tag small">‚Ç°800</div>
            </div>
        </div>

        <div class="menu-item extra-item" onclick="openManualEntry()">
            <div class="item-number">12</div>
            <div class="item-image-container">
                <div class="placeholder-img" style="background: #333; color: #aaa;">‚å®Ô∏è</div>
            </div>
            <div class="item-info">
                <div class="item-name">Manual Entry</div>
                <div class="price-tag small">Custom</div>
            </div>
        </div>
    </div>

    <!-- Bottom Bar -->
    <div class="bottom-bar">
        <div class="order-summary" onclick="toggleSummary()">
            <div id="summary-text">Cart Empty</div>
            <div id="total-text">‚Ç°0</div>
        </div>
        <div class="ready-time-selector" id="ready-time-selector" style="display: none;">
            <div style="font-size: 0.75rem; color: #888; margin-bottom: 4px; text-align: center;">Ready Time</div>
            <div style="display: flex; gap: 6px; justify-content: center;">
                <button id="ready-time-15" class="ready-time-chip" onclick="setOrderReadyTime(15)" aria-label="15 minutes">15</button>
                <button id="ready-time-20" class="ready-time-chip" onclick="setOrderReadyTime(20)" aria-label="20 minutes">20</button>
                <button id="ready-time-25" class="ready-time-chip" onclick="setOrderReadyTime(25)" aria-label="25 minutes">25</button>
                <button id="ready-time-30" class="ready-time-chip" onclick="setOrderReadyTime(30)" aria-label="30 minutes">30</button>
            </div>
        </div>
        <button class="btn btn-primary" style="height: 100%; border-radius: 0; font-size: 1.5rem; min-width: 120px;"
            onclick="showPaymentModal()">CHARGE</button>
    </div>

    <!-- Manual Entry Modal -->
    <div id="manual-modal" class="modal hidden">
        <div class="modal-content animate-pop" style="max-width: 320px;">
            <h2 style="margin-bottom: 20px;">Enter Price</h2>
            <!-- Changed to Input for Keyboard Support -->
            <input type="number" id="manual-input" placeholder="‚Ç°0"
                style="background: #000; color: var(--primary); font-size: 2.5rem; padding: 20px; border-radius: 12px; margin-bottom: 24px; font-weight: bold; border: 1px solid #333; width: 100%; text-align: center; outline: none;">

            <div class="numpad-grid">
                <button class="btn-num" onclick="numInput(1)">1</button>
                <button class="btn-num" onclick="numInput(2)">2</button>
                <button class="btn-num" onclick="numInput(3)">3</button>
                <button class="btn-num" onclick="numInput(4)">4</button>
                <button class="btn-num" onclick="numInput(5)">5</button>
                <button class="btn-num" onclick="numInput(6)">6</button>
                <button class="btn-num" onclick="numInput(7)">7</button>
                <button class="btn-num" onclick="numInput(8)">8</button>
                <button class="btn-num" onclick="numInput(9)">9</button>
                <button class="btn-num" onclick="numClear()">C</button>
                <button class="btn-num" onclick="numInput(0)">0</button>
                <button class="btn-num" onclick="addManualItem()">Add</button>
            </div>

            <button class="btn btn-secondary" onclick="closeManualModal()"
                style="width: 100%; margin-top: 24px; background: transparent; border: 1px solid #444;">Cancel</button>
        </div>
    </div>

    <!-- Review Modal -->
    <div id="review-modal" class="modal hidden">
        <div class="modal-content animate-pop" style="max-width: 500px;">
            <h2 style="margin-bottom: 8px;">Review Order</h2>
            <div style="color: var(--text-muted); margin-bottom: 24px;">Review and edit your order before payment</div>
            
            <div id="review-items" style="max-height: 400px; overflow-y: auto; margin-bottom: 20px; display: grid; gap: 12px;">
                <!-- Items injected here -->
            </div>
            
            <div style="border-top: 2px solid #333; padding-top: 16px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <span style="font-size: 1.3rem; font-weight: bold;">Total:</span>
                    <span id="review-total" style="font-size: 2rem; font-weight: bold; color: var(--primary);">‚Ç°0</span>
                </div>
                <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 16px;">
                    <div style="font-size: 0.9rem; color: #aaa; margin-bottom: 12px; text-align: center;">Order Ready Time</div>
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button id="review-ready-time-15" class="ready-time-chip" onclick="setOrderReadyTime(15); updateReviewReadyTimeUI();" aria-label="15 minutes">15</button>
                        <button id="review-ready-time-20" class="ready-time-chip" onclick="setOrderReadyTime(20); updateReviewReadyTimeUI();" aria-label="20 minutes">20</button>
                        <button id="review-ready-time-25" class="ready-time-chip" onclick="setOrderReadyTime(25); updateReviewReadyTimeUI();" aria-label="25 minutes">25</button>
                        <button id="review-ready-time-30" class="ready-time-chip" onclick="setOrderReadyTime(30); updateReviewReadyTimeUI();" aria-label="30 minutes">30</button>
                    </div>
                    <div style="text-align: center; margin-top: 8px; color: var(--primary); font-weight: bold; font-size: 1.1rem;" id="review-total-prep-time">15 min</div>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <button class="btn btn-secondary" onclick="closeReviewModal()"
                    style="background: transparent; border: 1px solid #444;">Edit Cart</button>
                <button class="btn btn-primary" onclick="proceedToPayment()">Proceed to Payment</button>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="payment-modal" class="modal hidden">
        <div class="modal-content animate-pop">
            <h2 style="margin-bottom: 8px;">Checkout</h2>
            <div style="color: var(--text-muted); margin-bottom: 24px;">Total: <span id="modal-total"
                    style="color: var(--primary);">‚Ç°0</span></div>

            <!-- Customer Name & Wait Time Inputs -->
            <div style="display: grid; gap: 12px; margin-bottom: 24px; text-align: left;">
                <label style="font-size: 0.9rem; color: #888;">Customer Name (Optional)</label>
                <input type="text" id="cust-name" placeholder="John Doe"
                    style="padding: 12px; background: #333; border: 1px solid #444; color: white; border-radius: 8px; font-size: 1.1rem;">

                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label style="font-size: 0.9rem; color: #888;">Order Ready Time</label>
                    <span id="wait-time-display" style="color: var(--primary); font-weight: bold; font-size: 1.1rem;">15 min</span>
                </div>
                <input type="hidden" id="wait-time-input" value="15">
            </div>

            <h3 style="margin-bottom: 16px; font-size: 1rem; color: #aaa;">Select Payment Method</h3>
            <div class="payment-options">
                <button class="btn-payment" onclick="processPayment('CASH')">üíµ CASH</button>
                <button class="btn-payment" onclick="processPayment('CARD')">üí≥ CARD</button>
                <button class="btn-payment" onclick="processPayment('OTHER')">üì± OTHER</button>
            </div>
            <button class="btn btn-secondary" onclick="closePaymentModal()"
                style="width: 100%; margin-top: 24px; background: transparent; border: 1px solid #444;">Cancel</button>
        </div>
    </div>

    <!-- Order Success Modal -->
    <div id="success-modal" class="modal hidden">
        <div class="modal-content animate-pop">
            <div style="font-size: 1.2rem; color: var(--success); font-weight: bold;">ORDER PLACED</div>
            <div id="success-order-num"
                style="font-size: 7rem; font-weight: 800; margin: 20px 0; line-height: 1; text-shadow: 0 0 30px rgba(0,230,118,0.3);">
                #37</div>
            <div style="margin-bottom: 24px; font-size: 1.1rem; color: #ccc;">Estimated Wait: <span id="success-time"
                    style="color: var(--primary); font-weight: bold;">15 mins</span></div>
            <button class="btn btn-primary" onclick="closeSuccessModal()" style="width: 100%;">Next Customer</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/staff.js"></script>
{% endblock %}